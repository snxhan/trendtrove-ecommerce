import{r as i,cb as x,cc as g,cd as q,k as v}from"./index-Cr7wFzsV.js";var E=()=>{const[n,r]=i.useState(""),[s,t]=i.useState(""),a=i.useCallback(x(o=>t(o),300),[]);return i.useEffect(()=>(a(n),()=>a.cancel()),[n,a]),{searchValue:n,onSearchValueChange:r,query:s||void 0}},C=({queryKey:n,queryFn:r,getOptions:s,defaultValue:t,defaultValueKey:a,pageSize:o=10})=>{const{searchValue:u,onSearchValueChange:b,query:f}=E(),p=a||"id",{data:h}=g({queryKey:n,queryFn:async()=>r({[p]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t}),{data:d,...l}=q({queryKey:[...n,f],queryFn:async({pageParam:e=0})=>await r({q:f,limit:o,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:v}),c=(d==null?void 0:d.pages.flatMap(e=>s(e)))??[],m=h?s(h):[],D=!l.isPending&&!c.length&&!u;return t&&m.length&&!u&&m.forEach(e=>{c.find(y=>y.value===e.value)||c.unshift(e)}),{options:c,searchValue:u,onSearchValueChange:b,disabled:D,...l}};export{E as a,C as u};
